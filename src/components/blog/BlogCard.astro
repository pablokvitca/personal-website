---
import TagBadge from '@/components/ui/TagBadge.astro';
import ToolingBadges from '@/components/ui/ToolingBadges.astro';
import { formatDate, getSlugFromId } from '@/lib/blog';
import { getNonTechnologyTags } from '@/lib/tags';
import type { BlogPost } from '@/lib/blog';

interface Props {
  post: BlogPost;
  index?: number;
}

const { post, index } = Astro.props;
const slug = getSlugFromId(post.id);
const nonTechTags = getNonTechnologyTags(post.data.tags);
---

<article class="border border-border rounded-lg p-6 hover:border-primary transition-colors">
  <a href={`/blog/${slug}`} class="block" data-analytics={index !== undefined ? `featured-blog-${index + 1}` : `blog-card-${slug}`}>
    <h2 class="text-xl font-semibold mb-2 hover:text-primary transition-colors">
      {post.data.title}
    </h2>
    <p class="text-muted-foreground mb-4 line-clamp-2">
      {post.data.abstract}
    </p>
    <div class={nonTechTags.length > 0 ? 'mb-2' : 'mb-4'}>
      <ToolingBadges tags={post.data.tags} />
    </div>
    {nonTechTags.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-4">
        {nonTechTags.map((tag) => <TagBadge tag={tag.raw} />)}
      </div>
    )}
    <time class="text-sm text-muted-foreground">
      {formatDate(post.data.publishedAt)}
    </time>
  </a>
</article>
